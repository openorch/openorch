<!--
 * @license
 * Copyright (c) The Authors (see the AUTHORS file)
 *
 * This source code is licensed under the GNU Affero General Public License v3.0 (AGPLv3) for personal, non-commercial use.
 * You may obtain a copy of the AGPL v3.0 at https://www.gnu.org/licenses/agpl-3.0.html.
 *
 * For commercial use, a separate license must be obtained by purchasing from The Authors.
 * For commercial licensing inquiries, please contact The Authors listed in the AUTHORS file.
 -->
<b-sidebar-page>
	<div class="flex-container">
		<div class="left-column">
			<div class="sng-test-open-new-thread" (click)="openNewThread()">
				<img src="/assets/logo-lighter.png" alt="Singulatron" class="logo" />
				<span class="brand-name">Singulatron</span>
				<ion-icon name="create-outline"></ion-icon>
			</div>
			<div
				*ngFor="let thread of chatThreads; let i = index"
				class="thread-item
				sng-test-thread-item
				sng-test-thread-item-index-{{ i }}"
				(click)="setThreadAsActive(thread)"
				[class.selected-thread]="thread?.id === activeThread?.id"
				[title]="thread?.title"
			>
				<div>
					<span
						style="color: #888"
						*ngIf="
							num(thread?.id, promptService.onPromptListUpdate$ | async) > 0
						"
						>{{
							num(thread?.id, promptService.onPromptListUpdate$ | async)
						}}</span
					>
					<span
						class="sng-test-streaming-is-in-progress"
						style="position: relative; top: 0.125rem; margin-right: 0.125rem"
						*ngIf="
							num(thread?.id, promptService.onPromptListUpdate$ | async) == 0
						"
					>
						<ion-icon
							class="flashing"
							style="color: rgb(250, 48, 48)"
							name="play-circle-outline"
						></ion-icon>
					</span>
					{{ thread?.title }}
				</div>
				<ion-icon
					(click)="removeChatThread(thread)"
					name="trash-outline"
					class="icon-delete"
				></ion-icon>
			</div>
		</div>
		<div class="right-column">
			<app-centered headerHeight="0vh" [vertical]="true">
				<app-chat-box
					*ngIf="activeThread"
					[thread]="activeThread"
					[promptTemplate]="model?.promptTemplate || defaultPrompt"
					(onCopyToClipboard)="onCopyToClipboard($event)"
				></app-chat-box>
			</app-centered>
		</div>
	</div>
</b-sidebar-page>
