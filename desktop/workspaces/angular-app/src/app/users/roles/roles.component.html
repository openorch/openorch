<!--
 * @license
 * Copyright (c) The Authors (see the AUTHORS file)
 *
 * This source code is licensed under the GNU Affero General Public License v3.0 (AGPLv3) for personal, non-commercial use.
 * You may obtain a copy of the AGPL v3.0 at https://www.gnu.org/licenses/agpl-3.0.html.
 *
 * For commercial use, a separate license must be obtained by purchasing from The Authors.
 * For commercial licensing inquiries, please contact The Authors listed in the AUTHORS file.
 -->
<b-sidebar-page>
	<ion-grid>
		<ion-row>
			<ion-col size="4">
				<ion-searchbar
					[(ngModel)]="roleSearchQuery"
					placeholder="Search Roles"
				></ion-searchbar>
				<ion-list>
					<ion-list-header>
						<ion-label>Roles</ion-label>
					</ion-list-header>
					<ion-item
						*ngFor="let role of filteredRoles()"
						(click)="selectRole(role)"
						[class.selected]="selectedRole?.id === role.id"
						button
					>
						<ion-label>{{ role?.name }}</ion-label>
					</ion-item>
				</ion-list>
			</ion-col>
			<ion-col size="8">
				<ion-item *ngIf="selectedRole">
					<ion-searchbar
						[(ngModel)]="permissionSearchQuery"
						placeholder="Search Permissions"
					></ion-searchbar>
					<ion-button
						slot="end"
						style="color: white"
						(click)="savePermissions()"
						>Save</ion-button
					>
				</ion-item>
				<ion-list *ngIf="selectedRole">
					<ion-list-header>
						<ion-label>Permissions</ion-label>
					</ion-list-header>
					<ion-item *ngFor="let permission of filteredPermissions()">
						<ion-checkbox
							class="custom-checkbox"
							slot="start"
							[checked]="selectedRolePermissions.has(permission.id || '')"
							(ionChange)="togglePermission(permission.id || '')"
						></ion-checkbox>
						<ion-label>{{ permission?.name }}</ion-label>
					</ion-item>
				</ion-list>
			</ion-col>
		</ion-row>
	</ion-grid>
</b-sidebar-page>
