<!--
 * @license
 * Copyright (c) The Authors (see the AUTHORS file)
 *
 * This source code is licensed under the GNU Affero General Public License v3.0 (AGPLv3) for personal, non-commercial use.
 * You may obtain a copy of the AGPL v3.0 at https://www.gnu.org/licenses/agpl-3.0.html.
 *
 * For commercial use, a separate license must be obtained by purchasing from The Authors.
 * For commercial licensing inquiries, please contact The Authors listed in the AUTHORS file.
 -->
<b-sidebar-page>
	<app-centered headerHeight="0vh" [vertical]="true">
		<div style="padding: 0rem 2rem">
			<h2 style="margin-bottom: 2rem">{{ 'Users' | translate }}</h2>

			<ion-list>
				<ng-container *ngFor="let user of users">
					<ion-item
						detail="false"
						lines="full"
						(click)="user.visible = !user.visible"
						button
					>
						<ion-label
							>{{ user.name }}
							<span style="color: #666">({{ user.email }})</span></ion-label
						>
						<ion-icon
							slot="end"
							style="color: #bdbdbd; font-size: 1.25rem"
							[name]="user.visible ? 'chevron-down' : 'chevron-forward'"
						></ion-icon>
					</ion-item>

					<ion-card-content
						*ngIf="user.visible"
						style="padding-top: 2em; padding-bottom: 2em"
					>
						<ion-item>
							<ion-input
								label="Name"
								labelPlacement="floating"
								type="text"
								[(ngModel)]="user.name"
								required
							></ion-input>
						</ion-item>

						<ion-item>
							<ion-input
								label="Email"
								labelPlacement="floating"
								type="text"
								[(ngModel)]="user.email"
								required
							></ion-input>
						</ion-item>

						<ion-item>
							<ion-input
								label="New Password"
								labelPlacement="floating"
								type="password"
								[(ngModel)]="password"
								placeholder="If you leave this blank, the password won't be changed"
							></ion-input>
						</ion-item>

						<ion-item *ngIf="password">
							<ion-input
								label="Password Confirmation"
								labelPlacement="floating"
								type="password"
								[(ngModel)]="passwordConfirmation"

							></ion-input>
						</ion-item>

						<ion-item>
							<ion-input
								label="Created At"
								labelPlacement="floating"
								type="text"
								disabled
								value="{{ user.createdAt | date }}"
							></ion-input>
						</ion-item>
						<ion-item>
							<ion-input
								label="Updated At"
								labelPlacement="floating"
								type="text"
								disabled
								value="{{ user.updatedAt | date }}"
							></ion-input>
						</ion-item>

						<ion-row style="margin-top: 1em">
							<ion-col size-lg="6" size-md="12" size-sm="12" size-xs="12">
								<ion-button
									style="margin-left: 0.75rem; color: white"
									(click)="saveUser(user)"
									>Save</ion-button
								>
							</ion-col>
						</ion-row>
					</ion-card-content>
				</ng-container>
			</ion-list>
		</div>
	</app-centered>
</b-sidebar-page>
